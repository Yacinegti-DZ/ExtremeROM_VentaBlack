From 0730b618b4452aae42d4e91051ea5d698c0a6d70 Mon Sep 17 00:00:00 2001
From: Salvo Giangreco <giangrecosalvo9@gmail.com>
Date: Sat, 14 Jun 2025 14:22:06 +0300
Subject: [PATCH] Disable screenshot detection

---
 .../com/android/server/wm/WindowManagerService.smali        | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/smali_classes2/com/android/server/wm/WindowManagerService.smali b/smali_classes2/com/android/server/wm/WindowManagerService.smali
index 125b6a7a..8e022b04 100644
--- a/smali_classes2/com/android/server/wm/WindowManagerService.smali
+++ b/smali_classes2/com/android/server/wm/WindowManagerService.smali
@@ -23948,20 +23948,26 @@
     const-string/jumbo v1, "notifyScreenshotListeners()"
 
     const/4 v2, 0x1
 
     invoke-virtual {p0, v0, v1, v2}, Lcom/android/server/wm/WindowManagerService;->checkCallingPermission$1(Ljava/lang/String;Ljava/lang/String;Z)Z
 
     move-result v0
 
     if-eqz v0, :cond_1
 
+    invoke-static {}, Ljava/util/Collections;->emptyList()Ljava/util/List;
+
+    move-result-object p0
+
+    return-object p0
+
     iget-object v0, p0, Lcom/android/server/wm/WindowManagerService;->mGlobalLock:Lcom/android/server/wm/WindowManagerGlobalLock;
 
     invoke-static {}, Lcom/android/server/wm/WindowManagerService;->boostPriorityForLockedSection()V
 
     monitor-enter v0
 
     :try_start_0
     iget-object p0, p0, Lcom/android/server/wm/WindowManagerService;->mRoot:Lcom/android/server/wm/RootWindowContainer;
 
     invoke-virtual {p0, p1}, Lcom/android/server/wm/RootWindowContainer;->getDisplayContent(I)Lcom/android/server/wm/DisplayContent;
-- 
2.45.2

